\chapter{Introduction}

The arrival of the Internet has completely revolutionized our personal and professional lives. With the rapid growth of Internet infrastructure, all the market sectors, social networking services, advertising and non-commerical sectors are using this technology in their workflow. This workflow eventually increased number of Internet users worldwide. As we become more dependent on the online environment, we can see massive growth of opportunities for IT criminals to take advantage of user systems. 

Internet users often share the sensitive information like bank account details or some other personal information, over the network. As personal computers and mobile phones became an important part in most people's lives, these computers became a hub of user's personal information. In this world of ubiquitous computers and persistent threats from hackers, protecting your computer is a must. Several websites are hacked to be used as distributors of malware, to infect the visitors unknowingly with viruses and malware. Single visit to a such a hacked web page is sufficient for an intruder to get the control of user's machine.

In late 2013, one of the bankâ€™s internal computers that are used by employees to process daily transfers and conduct bookkeeping, had been infected by malware that allowed cybercriminals to record their every move. The malicious software continuously monitored the banks activities for months, sending back video feeds and images to cyber criminals about the bank's daily routines. Then the group impersonated bank officers, not only turning on various cash machines, but also transferring millions of dollars from banks into dummy accounts set up in other countries.

Consider the fact that more than 6,600 benign websites are getting hacked every single day. These legitimate websites are turned into distributors of malware by malicious hackers. Malicious code can be injected into legitimate Javascript of a benign web page. When a user visits such a compromised website, this malicious JavaScript will be executed in the victim's web browser. Execution of such malicious JavaScript can infect victim's personal computer. Most of the times, malicious JavaScript redirects the victim's web browser to load more malicious code from a remote server. This can be achieved through several means, such as adding an HTML iframe element to a page. Always cybercriminals tries to obfuscate the malicious content from detection. HTML provides very few ways to obfuscate the code such as adding an HTML iframe element to a page but the huge number of methods in JavaScript makes it easy to heavily obfuscate the malicious code into Javascript.

The purpose of my research is to develop a Firefox browser plugin for Metamorphic JavaScript malware detection. In this research, we will use the Transcriptase metamorphic JavaScript malware, which is designed to infect other JavaScript files in the same folder. During the Add-on development, we consider a variety of static detection techniques and quantify the effectiveness of each. 

This paper is organized as follows. In Chapter 2, we provide background information on metamorphic malware and with an emphasis on Transcriptase metamorphic JavaScript malware that forms the basis for the research. Also in this chapter, we cover the Rhino Javascript engine. Chapter 3 outlines the details of firefox Add-on development. Then in Chapter 4, we discuss two different static metamorphic detection techniques that we apply to detect the metamorphic JavaScript malware. In Chapter 5, we present the accuracy and performance details of Firefox Add-on using opcode similarity detection technique. Our experimental results for the original metamorphic JavaScript appear. Chapter 6 contains the conclusion and consideration for future work.

\section{Problem} 

Malware is a malicious software, specifically designed to gain access to the data or to damage the resources without the knowledge of victim. Researchers developed various techniques for malware detection like signature based detection and heuristic analysis. To overcome the malware detection techniques, malware writers came up with different types of Malwares among which Metamorphic Malware is an advanced version. Metamorphic malware is capable of changing its internal structure without altering its functionality from infection to infection. Due to the metamorphic nature, such malware is very difficult to detect. With a huge set of functions, JavaScript makes it possible for virus writers to develop malicious JavaScript code with metamorphic feature. Transcriptase is such a case.

\section{Proposed Solution}

In spite of the fact that malware can change their internal structure the priority order of the important commands cannot be changed. Case in point, consider a sample JavaScript code below,

\begin{lstlisting}
//sample.js
<script>
    var x = 5;
    var y = 6;
    var z = x + y;
</script>
\end{lstlisting}

The above code can be morphed as,
\begin{lstlisting}
//sample_morphed.js
<script>
    var y_renamed = 6;
    var x_renamed = 5;
    var z_renamed = x_renamed + y_renamed;
</script>
\end{lstlisting}

From the above example, it is clear that even though the variable names are changed and the order of declaration of x and y  (or x\_renamed and y\_renamed) are changed, the arithmetic operation always follows the declaration of those two variables else the code may give syntactical errors or wrong result.

So, we can make use of the opcodes statistical information to detect the malware. 

\section{Why my approach is good?}

Generally JavaScript malware will be inducted into benign web pages. When a user visits this infected website, the malicious JavaScript code will be executed in the browser. To prevent this, we can develop an add-on which will monitor the JavaScript content of the every web page and  browser disable the JavaScript execution before the page gets loaded. Add-on will analyze the JavaScript in the background and will enable the JavaScript load, if the web page found to be benign or else prompt the user about malicious content without loading the JavaScript. This procedure can secure the victim's computer from malware infection.